@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@using PugetSound
@using PugetSound.Logic
@model PugetSound.Models.IndexModel
@{
    ViewData["Title"] = "PugetSound";
}

<div class="container">
    <div class="row">
        <div class="col-12">
            <h1>Welcome <span>@Model.FriendlyName</span></h1>
            <p><strong>PugetSound</strong> allows you and your group to enjoy music together using Spotify.</p>
            <div class="mt-3 mb-3 pl-3 border-left border-success">
                <p>You are signed into Spotify with the username: <a href="@Model.ProfileLink">@Model.UserName</a></p>
                <p class="mb-0">@Model.PlaylistMessage<a href="@Model.PlaylistLink">@Constants.QueuePlaylistName</a></p>
            </div>
            <hr />
            <h2>Join or create room</h2>
            @if (Model.IsAlreadyInRoom)
            {
                <div class="alert alert-info">
                    <p>You've joined room <strong>@Model.RoomName</strong> previously, so that has been pre-filled below. Just press [Enter room] to continue.</p>
                    <p class="mb-0">If you enter a different room name you'll leave your current one.</p>
                </div>
            }
            <form method="post" asp-contoller="Index" asp-action="Room">
                <input type="hidden" asp-for="PlaylistId" value="@Model.PlaylistId"/>
                <input asp-for="RoomName" pattern="[a-z]{3,}" value="@Model.RoomName"/>
                <input type="submit" value="Enter room"/>
            </form>
            <hr />
            <h2>How it works</h2>
            <p>PugetSound creates a playlist called "PugetSound Queue" in your Spotify account. When you join a room and become a DJ, you'll take turns to play a song for the room members. When it's your turn, the first song from your queue playlist will be played for everyone, and it'll be also removed from said playlist. (Therefore it's not recommended to use it for other purposes.)</p>
            <p>Unlike other solutions, PugetSound handles the synchronization and queueing on the backend, so it's not necessary to keep the tab open - as long as you have a Spotify player open on a device. This also means that you need to re-enter the room and explicitly press the [Leave room] button to retake control of your Spotify account.</p>
            <h2>Requirements</h2>
            <p>1. Spotify Premium: Apparently a premium account is required to play songs via the API.</p>
            <p>2. Keeping <em>a</em> Spotify player open <em>somewhere</em>. This can be the desktop client, your phone or the web app. Doesn't matter, but the music needs to come from somewhere.</p>
            <h2>Everything else</h2>
            <p>This is an open source project <a href="https://github.com/tomzorz/PugetSound">available on GitHub</a>!</p>
        </div>
    </div>
</div>